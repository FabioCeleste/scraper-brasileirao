#!/usr/bin/env sh

ENABLE_PATTERN=true
PROJECT_NAME="MY-PROJECT"

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$1")

# Conventional-commit style (type: description) â€“ at least 3 chars after the colon
PATTERN="^(feat|fix|docs|style|refactor|perf|test|ci|chore|revert): .{3,}$"

if [ "$ENABLE_PATTERN" = true ]; then
  if ! echo "$COMMIT_MSG" | grep -Eq "$PATTERN"; then
      echo "***************************************************************************************"
      echo "ğŸš«ğŸš«ğŸš«  ERROR: Your commit message doesnâ€™t match the required pattern!  ğŸš«ğŸš«ğŸš«"
      echo "======================================================================================="
      echo "ğŸ’¡  Allowed types: feat | fix | docs | style | refactor | perf | test | ci | chore | revert"
      echo "ğŸ’¡  Description must contain at least 3 characters"
      echo "ğŸ’¡  Valid examples:"
      echo "     feat: add login system"
      echo "     fix: correct email validation bug"
      echo "     docs: update README"
      echo "======================================================================================="
      echo "ğŸ“  Your message: '$COMMIT_MSG'"
      echo "ğŸ”—  Learn more about Conventional Commits:"
      echo "ğŸ”—  https://www.conventionalcommits.org/en/v1.0.0/"
      echo "***************************************************************************************"
      exit 1
  else
      echo "âœ…  Commit accepted â€” thanks for keeping the history clean! ğŸ‰"
  fi
else
    echo "=========================================================="
    echo "|| âš ï¸  NOTICE: Commit-message validation is currently disabled âš ï¸ ||"
    echo "=========================================================="
fi
